{% extends 'base.html' %}
{% load static %}

{% block title %}Budget Manager{% endblock %}

{% block content %}
<div class="container-fluid px-2">

    <!-- Mobile-friendly header buttons -->
    <div class="card mb-3">
        <div class="card-header p-0">
            <div class="d-flex flex-row flex-nowrap overflow-auto gap-2 p-2">
                <a href="{% url 'assets:indexManager' 'MTFT' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    MTFT
                </a>
                <a href="{% url 'assets:indexManager' 'INTRA' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Intra Day
                </a>
                <a href="{% url 'assets:indexManager' 'SWING' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Swing
                </a>
                <a href="{% url 'assets:indexManager' 'LONG' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Long
                </a>
                <a href="{% url 'assets:indexManager' 'OPTION' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Option
                </a>
                <a href="{% url 'assets:indexManager' 'MF' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Mutual Funds
                </a>
                <a href="{% url 'assets:dividentManager' %}" class="btn btn-primary btn-sm flex-shrink-0">
                    Dividend
                </a>
            </div>
        </div>
    </div>

    <!-- Content Body -->
    <div class="card">
        <div class="card-body px-2">

            <!-- Mobile cards instead of table -->
            <div class="row">
                <div class="col-12">
                        <form method="get" id="filterForm" class="d-flex flex-wrap gap-2 mb-3 align-items-center">
                            <button type="button" class="btn btn-secondary">
                                Overall Profit: <b>{{ overallProfit | floatformat:3 }}</b><br>
                                Overall Brockerage & Tax: <b>{{ overallTax | floatformat:3 }}</b>
                            </button>
                            <select name="year" id="yearSelect" class="form-select w-auto flex-grow-1">
                                {% for y in finYears %}
                                    <option value="{{ y.id }}" {% if y.id == selected_year_id %}selected{% endif %}>
                                        {{ y.year }}
                                    </option>
                                {% endfor %}
                            </select>
                            <button type="submit" class="btn btn-primary">
                                Filter
                            </button>
                        </form>
                    <!-- Use Bootstrap list-group for mobile readability -->
                    <ul class="list-group">
                        <li class="list-group-item d-flex justify-content-between align-items-center profit-positive">
                            <strong class="small">Total Profit From Trading include Divident</strong>
                            <span class="small">{{ totalProfit | floatformat:3 }}</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center profit-negative">
                            <strong class="small">Total Brockerage & Tax</strong>
                            <span class="small">{{ totalTax | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong class="small">Amount Used For MF</strong>
                            <span class="small">0</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center profit-positive">
                            <strong class="small">Total Dividend Amount</strong>
                            <span class="small">{{ divAmount | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong class="small">Total Amount Used for Trading</strong>
                            <span class="small">0</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if mtfProfit > 0 %} profit-positive {% elif mtfProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From MTF</strong>
                            <span class="small">{{ mtfProfit | floatformat:3}}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if optionProfit > 0 %} profit-positive {% elif optionProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From Option</strong>
                            <span class="small">{{ optionProfit | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if intraProfit > 0 %} profit-positive {% elif intraProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From IntraDay</strong>
                            <span class="small">{{ intraProfit | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if swingProfit > 0 %} profit-positive {% elif swingProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From Swing</strong>
                            <span class="small">{{ swingProfit | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if longProfit > 0 %} profit-positive {% elif longProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From Long</strong>
                            <span class="small">{{ longProfit | floatformat:3 }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center {% if mfProfit > 0 %} profit-positive {% elif mfProfit <= 0 %} profit-negative{% endif %}">
                            <strong class="small">Profit From MF</strong>
                            <span class="small">{{ mfProfit }}</span>
                        </li>

                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <strong class="small">Total Amount In Trading</strong>
                            <span class="small">0</span>
                        </li>

                    </ul>

                </div>
            </div>
        </div>
    </div>

</div>
{% endblock %}
